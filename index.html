<!DOCTYPE HTML>
<html>
    <head>
        <link rel="stylesheet" href="libs/webix/webix.css" type="text/css"> 
        <link rel="stylesheet" href="css/style.css" type="text/css"> 
        <script src="libs/webix/webix.js" type="text/javascript"></script>
    </head>
    <body>
        <script type="module">
            
            import {header, profilePopup} from "./js/header.js";
            import {main} from "./js/main/main.js";
            import {footer} from "./js/footer.js";
            import {side} from "./js/main/side.js";

            webix.ready(function(){
                
                webix.ui(
                    profilePopup
                );

                webix.ui({
                    rows: [
                        header,
                        { cols:[ side, { view:"resizer" }, main] },
                        footer
                    ]
                });

                $$("side").select("dashboard_view");
                $$("form_movie").bind("table_movies");
                $$("table_movies").sort("#id#", "asc");
                $$("users_text").attachEvent("onTimedKeyPress", function(){
                    const text = this.getValue().toLowerCase();
                    $$("users_list").filter(function(obj) {
                        return obj.name.toLowerCase().indexOf(text) !== -1;
                    });
                });
                $$("users_list").attachEvent("onAfterRender", selectTop5Items);
                $$("products_treetable").load("data/products.js");
                $$("products_treetable").attachEvent("onAfterLoad", function() {
                    this.openAll();
                });
            });

            function selectTop5Items() {
                const list = $$("users_list");
                list.clearCss("selection-top");
                for (let i = 0; i < (list.count() > 4 ? 5 : list.count()); i++ ) {
                    list.addCss(list.data.order[i], "selection-top");
                }
            } 


        </script>
    </body>
</html>